webpackJsonp([6],{"2F6b":function(e,t){},y8H8:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("Ml+6"),o=n("BMSc"),a=function(e,t){void 0===t&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),i.Object3D.call(this),this.visible=!1,this.domElement=t;var n=new r;this.add(n);var o=new s;this.add(o);var a=this;k("camera",e),k("object",void 0),k("enabled",!0),k("axis",null),k("mode","translate"),k("translationSnap",null),k("rotationSnap",null),k("scaleSnap",null),k("space","world"),k("size",1),k("dragging",!1),k("showX",!0),k("showY",!0),k("showZ",!0);var l={type:"change"},h={type:"mouseDown"},c={type:"mouseUp",mode:a.mode},p={type:"objectChange"},u=new i.Raycaster;function d(e,t,n){for(var i=t.intersectObject(e,!0),o=0;o<i.length;o++)if(i[o].object.visible||n)return i[o];return!1}var m=new i.Vector3,w=new i.Vector3,y=new i.Quaternion,f={X:new i.Vector3(1,0,0),Y:new i.Vector3(0,1,0),Z:new i.Vector3(0,0,1)},v=new i.Vector3,M=new i.Vector3,b=new i.Vector3,g=new i.Vector3,x=new i.Vector3,P=new i.Vector3,L=0,X=new i.Vector3,B=new i.Quaternion,S=new i.Vector3,Y=new i.Vector3,E=new i.Quaternion,Z=new i.Quaternion,C=new i.Vector3,Q=new i.Vector3,I=new i.Quaternion,j=new i.Vector3,G=new i.Vector3,z=new i.Quaternion,A=new i.Quaternion,T=new i.Vector3,V=new i.Vector3,O=new i.Vector3,D=new i.Quaternion,F=new i.Vector3;function k(e,t){var i=t;Object.defineProperty(a,e,{get:function(){return void 0!==i?i:t},set:function(t){i!==t&&(i=t,o[e]=t,n[e]=t,a.dispatchEvent({type:e+"-changed",value:t}),a.dispatchEvent(l))}}),a[e]=t,o[e]=t,n[e]=t}function W(e){if(a.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:e.button};var n=e.changedTouches?e.changedTouches[0]:e,i=t.getBoundingClientRect();return{x:(n.clientX-i.left)/i.width*2-1,y:-(n.clientY-i.top)/i.height*2+1,button:e.button}}function q(e){if(a.enabled)switch(e.pointerType){case"mouse":case"pen":a.pointerHover(W(e))}}function R(e){a.enabled&&(a.domElement.style.touchAction="none",a.domElement.ownerDocument.addEventListener("pointermove",_,!1),a.pointerHover(W(e)),a.pointerDown(W(e)))}function _(e){a.enabled&&a.pointerMove(W(e))}function H(e){a.enabled&&(a.domElement.style.touchAction="",a.domElement.ownerDocument.removeEventListener("pointermove",_,!1),a.pointerUp(W(e)))}k("worldPosition",G),k("worldPositionStart",Q),k("worldQuaternion",z),k("worldQuaternionStart",I),k("cameraPosition",X),k("cameraQuaternion",B),k("pointStart",v),k("pointEnd",M),k("rotationAxis",g),k("rotationAngle",L),k("eye",V),t.addEventListener("pointerdown",R,!1),t.addEventListener("pointermove",q,!1),a.domElement.ownerDocument.addEventListener("pointerup",H,!1),this.dispose=function(){t.removeEventListener("pointerdown",R),t.removeEventListener("pointermove",q),a.domElement.ownerDocument.removeEventListener("pointermove",_),a.domElement.ownerDocument.removeEventListener("pointerup",H),this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})},this.attach=function(e){return this.object=e,this.visible=!0,this},this.detach=function(){return this.object=void 0,this.visible=!1,this.axis=null,this},this.updateMatrixWorld=function(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(Y,E,C),this.object.matrixWorld.decompose(G,z,T),Z.copy(E).invert(),A.copy(z).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(X,B,S),V.copy(X).sub(G).normalize(),i.Object3D.prototype.updateMatrixWorld.call(this)},this.pointerHover=function(e){if(void 0!==this.object&&!0!==this.dragging){u.setFromCamera(e,this.camera);var t=d(n.picker[this.mode],u);this.axis=t?t.object.name:null}},this.pointerDown=function(e){if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){u.setFromCamera(e,this.camera);var t=d(o,u,!0);if(t){var n=this.space;if("scale"===this.mode?n="local":"E"!==this.axis&&"XYZE"!==this.axis&&"XYZ"!==this.axis||(n="world"),"local"===n&&"rotate"===this.mode){var i=this.rotationSnap;"X"===this.axis&&i&&(this.object.rotation.x=Math.round(this.object.rotation.x/i)*i),"Y"===this.axis&&i&&(this.object.rotation.y=Math.round(this.object.rotation.y/i)*i),"Z"===this.axis&&i&&(this.object.rotation.z=Math.round(this.object.rotation.z/i)*i)}this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),O.copy(this.object.position),D.copy(this.object.quaternion),F.copy(this.object.scale),this.object.matrixWorld.decompose(Q,I,j),v.copy(t.point).sub(Q)}this.dragging=!0,h.mode=this.mode,this.dispatchEvent(h)}},this.pointerMove=function(e){var t=this.axis,n=this.mode,i=this.object,a=this.space;if("scale"===n?a="local":"E"!==t&&"XYZE"!==t&&"XYZ"!==t||(a="world"),void 0!==i&&null!==t&&!1!==this.dragging&&-1===e.button){u.setFromCamera(e,this.camera);var r=d(o,u,!0);if(r){if(M.copy(r.point).sub(Q),"translate"===n)b.copy(M).sub(v),"local"===a&&"XYZ"!==t&&b.applyQuaternion(A),-1===t.indexOf("X")&&(b.x=0),-1===t.indexOf("Y")&&(b.y=0),-1===t.indexOf("Z")&&(b.z=0),"local"===a&&"XYZ"!==t?b.applyQuaternion(D).divide(C):b.applyQuaternion(Z).divide(C),i.position.copy(b).add(O),this.translationSnap&&("local"===a&&(i.position.applyQuaternion(y.copy(D).invert()),-1!==t.search("X")&&(i.position.x=Math.round(i.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(i.position.y=Math.round(i.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(i.position.z=Math.round(i.position.z/this.translationSnap)*this.translationSnap),i.position.applyQuaternion(D)),"world"===a&&(i.parent&&i.position.add(m.setFromMatrixPosition(i.parent.matrixWorld)),-1!==t.search("X")&&(i.position.x=Math.round(i.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(i.position.y=Math.round(i.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(i.position.z=Math.round(i.position.z/this.translationSnap)*this.translationSnap),i.parent&&i.position.sub(m.setFromMatrixPosition(i.parent.matrixWorld))));else if("scale"===n){if(-1!==t.search("XYZ")){var s=M.length()/v.length();M.dot(v)<0&&(s*=-1),w.set(s,s,s)}else m.copy(v),w.copy(M),m.applyQuaternion(A),w.applyQuaternion(A),w.divide(m),-1===t.search("X")&&(w.x=1),-1===t.search("Y")&&(w.y=1),-1===t.search("Z")&&(w.z=1);i.scale.copy(F).multiply(w),this.scaleSnap&&(-1!==t.search("X")&&(i.scale.x=Math.round(i.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(i.scale.y=Math.round(i.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(i.scale.z=Math.round(i.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===n){b.copy(M).sub(v);var h=20/G.distanceTo(m.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(g.copy(V),L=M.angleTo(v),x.copy(v).normalize(),P.copy(M).normalize(),L*=P.cross(x).dot(V)<0?1:-1):"XYZE"===t?(g.copy(b).cross(V).normalize(),L=b.dot(m.copy(g).cross(this.eye))*h):"X"!==t&&"Y"!==t&&"Z"!==t||(g.copy(f[t]),m.copy(f[t]),"local"===a&&m.applyQuaternion(z),L=b.dot(m.cross(V).normalize())*h),this.rotationSnap&&(L=Math.round(L/this.rotationSnap)*this.rotationSnap),this.rotationAngle=L,"local"===a&&"E"!==t&&"XYZE"!==t?(i.quaternion.copy(D),i.quaternion.multiply(y.setFromAxisAngle(g,L)).normalize()):(g.applyQuaternion(Z),i.quaternion.copy(y.setFromAxisAngle(g,L)),i.quaternion.multiply(D).normalize())}this.dispatchEvent(l),this.dispatchEvent(p)}}},this.pointerUp=function(e){0===e.button&&(this.dragging&&null!==this.axis&&(c.mode=this.mode,this.dispatchEvent(c)),this.dragging=!1,this.axis=null)},this.getMode=function(){return a.mode},this.setMode=function(e){a.mode=e},this.setTranslationSnap=function(e){a.translationSnap=e},this.setRotationSnap=function(e){a.rotationSnap=e},this.setScaleSnap=function(e){a.scaleSnap=e},this.setSize=function(e){a.size=e},this.setSpace=function(e){a.space=e},this.update=function(){console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}};a.prototype=Object.assign(Object.create(i.Object3D.prototype),{constructor:a,isTransformControls:!0});var r=function(){i.Object3D.call(this),this.type="TransformControlsGizmo";var e=new i.MeshBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,side:i.DoubleSide,fog:!1,toneMapped:!1}),t=new i.LineBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1,toneMapped:!1}),n=e.clone();n.opacity=.15;var o=e.clone();o.opacity=.33;var a=e.clone();a.color.set(16711680);var r=e.clone();r.color.set(65280);var s=e.clone();s.color.set(255);var l=e.clone();l.opacity=.25;var h=l.clone();h.color.set(16776960);var c=l.clone();c.color.set(65535);var p=l.clone();p.color.set(16711935),e.clone().color.set(16776960);var u=t.clone();u.color.set(16711680);var d=t.clone();d.color.set(65280);var m=t.clone();m.color.set(255);var w=t.clone();w.color.set(65535);var y=t.clone();y.color.set(16711935);var f=t.clone();f.color.set(16776960);var v=t.clone();v.color.set(7895160);var M=f.clone();M.opacity=.25;var b=new i.CylinderBufferGeometry(0,.05,.2,12,1,!1),g=new i.BoxBufferGeometry(.125,.125,.125),x=new i.BufferGeometry;x.setAttribute("position",new i.Float32BufferAttribute([0,0,0,1,0,0],3));var P,L=function(e,t){for(var n=new i.BufferGeometry,o=[],a=0;a<=64*t;++a)o.push(0,Math.cos(a/32*Math.PI)*e,Math.sin(a/32*Math.PI)*e);return n.setAttribute("position",new i.Float32BufferAttribute(o,3)),n},X={X:[[new i.Mesh(b,a),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new i.Mesh(b,a),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new i.Line(x,u)]],Y:[[new i.Mesh(b,r),[0,1,0],null,null,"fwd"],[new i.Mesh(b,r),[0,1,0],[Math.PI,0,0],null,"bwd"],[new i.Line(x,d),null,[0,0,Math.PI/2]]],Z:[[new i.Mesh(b,s),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new i.Mesh(b,s),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new i.Line(x,m),null,[0,-Math.PI/2,0]]],XYZ:[[new i.Mesh(new i.OctahedronBufferGeometry(.1,0),l.clone()),[0,0,0],[0,0,0]]],XY:[[new i.Mesh(new i.PlaneBufferGeometry(.295,.295),h.clone()),[.15,.15,0]],[new i.Line(x,f),[.18,.3,0],null,[.125,1,1]],[new i.Line(x,f),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new i.Mesh(new i.PlaneBufferGeometry(.295,.295),c.clone()),[0,.15,.15],[0,Math.PI/2,0]],[new i.Line(x,w),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new i.Line(x,w),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new i.Mesh(new i.PlaneBufferGeometry(.295,.295),p.clone()),[.15,0,.15],[-Math.PI/2,0,0]],[new i.Line(x,y),[.18,0,.3],null,[.125,1,1]],[new i.Line(x,y),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]},B={X:[[new i.Mesh(new i.CylinderBufferGeometry(.2,0,1,4,1,!1),n),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new i.Mesh(new i.CylinderBufferGeometry(.2,0,1,4,1,!1),n),[0,.6,0]]],Z:[[new i.Mesh(new i.CylinderBufferGeometry(.2,0,1,4,1,!1),n),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new i.Mesh(new i.OctahedronBufferGeometry(.2,0),n)]],XY:[[new i.Mesh(new i.PlaneBufferGeometry(.4,.4),n),[.2,.2,0]]],YZ:[[new i.Mesh(new i.PlaneBufferGeometry(.4,.4),n),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new i.Mesh(new i.PlaneBufferGeometry(.4,.4),n),[.2,0,.2],[-Math.PI/2,0,0]]]},S={START:[[new i.Mesh(new i.OctahedronBufferGeometry(.01,2),o),null,null,null,"helper"]],END:[[new i.Mesh(new i.OctahedronBufferGeometry(.01,2),o),null,null,null,"helper"]],DELTA:[[new i.Line((P=new i.BufferGeometry,P.setAttribute("position",new i.Float32BufferAttribute([0,0,0,1,1,1],3)),P),o),null,null,null,"helper"]],X:[[new i.Line(x,o.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new i.Line(x,o.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new i.Line(x,o.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},Y={X:[[new i.Line(L(1,.5),u)],[new i.Mesh(new i.OctahedronBufferGeometry(.04,0),a),[0,0,.99],null,[1,3,1]]],Y:[[new i.Line(L(1,.5),d),null,[0,0,-Math.PI/2]],[new i.Mesh(new i.OctahedronBufferGeometry(.04,0),r),[0,0,.99],null,[3,1,1]]],Z:[[new i.Line(L(1,.5),m),null,[0,Math.PI/2,0]],[new i.Mesh(new i.OctahedronBufferGeometry(.04,0),s),[.99,0,0],null,[1,3,1]]],E:[[new i.Line(L(1.25,1),M),null,[0,Math.PI/2,0]],[new i.Mesh(new i.CylinderBufferGeometry(.03,0,.15,4,1,!1),M),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new i.Mesh(new i.CylinderBufferGeometry(.03,0,.15,4,1,!1),M),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new i.Mesh(new i.CylinderBufferGeometry(.03,0,.15,4,1,!1),M),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new i.Mesh(new i.CylinderBufferGeometry(.03,0,.15,4,1,!1),M),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new i.Line(L(1,1),v),null,[0,Math.PI/2,0]]]},E={AXIS:[[new i.Line(x,o.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},Z={X:[[new i.Mesh(new i.TorusBufferGeometry(1,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new i.Mesh(new i.TorusBufferGeometry(1,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new i.Mesh(new i.TorusBufferGeometry(1,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new i.Mesh(new i.TorusBufferGeometry(1.25,.1,2,24),n)]],XYZE:[[new i.Mesh(new i.SphereBufferGeometry(.7,10,8),n)]]},C={X:[[new i.Mesh(g,a),[.8,0,0],[0,0,-Math.PI/2]],[new i.Line(x,u),null,null,[.8,1,1]]],Y:[[new i.Mesh(g,r),[0,.8,0]],[new i.Line(x,d),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new i.Mesh(g,s),[0,0,.8],[Math.PI/2,0,0]],[new i.Line(x,m),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new i.Mesh(g,h),[.85,.85,0],null,[2,2,.2]],[new i.Line(x,f),[.855,.98,0],null,[.125,1,1]],[new i.Line(x,f),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new i.Mesh(g,c),[0,.85,.85],null,[.2,2,2]],[new i.Line(x,w),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new i.Line(x,w),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new i.Mesh(g,p),[.85,0,.85],null,[2,.2,2]],[new i.Line(x,y),[.855,0,.98],null,[.125,1,1]],[new i.Line(x,y),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new i.Mesh(new i.BoxBufferGeometry(.125,.125,.125),l.clone()),[1.1,0,0]]],XYZY:[[new i.Mesh(new i.BoxBufferGeometry(.125,.125,.125),l.clone()),[0,1.1,0]]],XYZZ:[[new i.Mesh(new i.BoxBufferGeometry(.125,.125,.125),l.clone()),[0,0,1.1]]]},Q={X:[[new i.Mesh(new i.CylinderBufferGeometry(.2,0,.8,4,1,!1),n),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new i.Mesh(new i.CylinderBufferGeometry(.2,0,.8,4,1,!1),n),[0,.5,0]]],Z:[[new i.Mesh(new i.CylinderBufferGeometry(.2,0,.8,4,1,!1),n),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new i.Mesh(g,n),[.85,.85,0],null,[3,3,.2]]],YZ:[[new i.Mesh(g,n),[0,.85,.85],null,[.2,3,3]]],XZ:[[new i.Mesh(g,n),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new i.Mesh(new i.BoxBufferGeometry(.2,.2,.2),n),[1.1,0,0]]],XYZY:[[new i.Mesh(new i.BoxBufferGeometry(.2,.2,.2),n),[0,1.1,0]]],XYZZ:[[new i.Mesh(new i.BoxBufferGeometry(.2,.2,.2),n),[0,0,1.1]]]},I={X:[[new i.Line(x,o.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new i.Line(x,o.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new i.Line(x,o.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},j=function(e){var t=new i.Object3D;for(var n in e)for(var o=e[n].length;o--;){var a=e[n][o][0].clone(),r=e[n][o][1],s=e[n][o][2],l=e[n][o][3],h=e[n][o][4];a.name=n,a.tag=h,r&&a.position.set(r[0],r[1],r[2]),s&&a.rotation.set(s[0],s[1],s[2]),l&&a.scale.set(l[0],l[1],l[2]),a.updateMatrix();var c=a.geometry.clone();c.applyMatrix4(a.matrix),a.geometry=c,a.renderOrder=1/0,a.position.set(0,0,0),a.rotation.set(0,0,0),a.scale.set(1,1,1),t.add(a)}return t},G=new i.Vector3(0,0,0),z=new i.Euler,A=new i.Vector3(0,1,0),T=new i.Vector3(0,0,0),V=new i.Matrix4,O=new i.Quaternion,D=new i.Quaternion,F=new i.Quaternion,k=new i.Vector3(1,0,0),W=new i.Vector3(0,1,0),q=new i.Vector3(0,0,1);this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=j(X)),this.add(this.gizmo.rotate=j(Y)),this.add(this.gizmo.scale=j(C)),this.add(this.picker.translate=j(B)),this.add(this.picker.rotate=j(Z)),this.add(this.picker.scale=j(Q)),this.add(this.helper.translate=j(S)),this.add(this.helper.rotate=j(E)),this.add(this.helper.scale=j(I)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1,this.updateMatrixWorld=function(){var e=this.space;"scale"===this.mode&&(e="local");var t="local"===e?this.worldQuaternion:F;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;var n=[];n=(n=(n=n.concat(this.picker[this.mode].children)).concat(this.gizmo[this.mode].children)).concat(this.helper[this.mode].children);for(var o=0;o<n.length;o++){var a,r=n[o];if(r.visible=!0,r.rotation.set(0,0,0),r.position.copy(this.worldPosition),a=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),r.scale.set(1,1,1).multiplyScalar(a*this.size/7),"helper"!==r.tag){if(r.quaternion.copy(t),"translate"===this.mode||"scale"===this.mode){"X"!==r.name&&"XYZX"!==r.name||Math.abs(A.copy(k).applyQuaternion(t).dot(this.eye))>.99&&(r.scale.set(1e-10,1e-10,1e-10),r.visible=!1),"Y"!==r.name&&"XYZY"!==r.name||Math.abs(A.copy(W).applyQuaternion(t).dot(this.eye))>.99&&(r.scale.set(1e-10,1e-10,1e-10),r.visible=!1),"Z"!==r.name&&"XYZZ"!==r.name||Math.abs(A.copy(q).applyQuaternion(t).dot(this.eye))>.99&&(r.scale.set(1e-10,1e-10,1e-10),r.visible=!1),"XY"===r.name&&Math.abs(A.copy(q).applyQuaternion(t).dot(this.eye))<.2&&(r.scale.set(1e-10,1e-10,1e-10),r.visible=!1),"YZ"===r.name&&Math.abs(A.copy(k).applyQuaternion(t).dot(this.eye))<.2&&(r.scale.set(1e-10,1e-10,1e-10),r.visible=!1),"XZ"===r.name&&Math.abs(A.copy(W).applyQuaternion(t).dot(this.eye))<.2&&(r.scale.set(1e-10,1e-10,1e-10),r.visible=!1),-1!==r.name.search("X")&&(A.copy(k).applyQuaternion(t).dot(this.eye)<0?"fwd"===r.tag?r.visible=!1:r.scale.x*=-1:"bwd"===r.tag&&(r.visible=!1)),-1!==r.name.search("Y")&&(A.copy(W).applyQuaternion(t).dot(this.eye)<0?"fwd"===r.tag?r.visible=!1:r.scale.y*=-1:"bwd"===r.tag&&(r.visible=!1)),-1!==r.name.search("Z")&&(A.copy(q).applyQuaternion(t).dot(this.eye)<0?"fwd"===r.tag?r.visible=!1:r.scale.z*=-1:"bwd"===r.tag&&(r.visible=!1))}else"rotate"===this.mode&&(D.copy(t),A.copy(this.eye).applyQuaternion(O.copy(t).invert()),-1!==r.name.search("E")&&r.quaternion.setFromRotationMatrix(V.lookAt(this.eye,T,W)),"X"===r.name&&(O.setFromAxisAngle(k,Math.atan2(-A.y,A.z)),O.multiplyQuaternions(D,O),r.quaternion.copy(O)),"Y"===r.name&&(O.setFromAxisAngle(W,Math.atan2(A.x,A.z)),O.multiplyQuaternions(D,O),r.quaternion.copy(O)),"Z"===r.name&&(O.setFromAxisAngle(q,Math.atan2(A.y,A.x)),O.multiplyQuaternions(D,O),r.quaternion.copy(O)));r.visible=r.visible&&(-1===r.name.indexOf("X")||this.showX),r.visible=r.visible&&(-1===r.name.indexOf("Y")||this.showY),r.visible=r.visible&&(-1===r.name.indexOf("Z")||this.showZ),r.visible=r.visible&&(-1===r.name.indexOf("E")||this.showX&&this.showY&&this.showZ),r.material._opacity=r.material._opacity||r.material.opacity,r.material._color=r.material._color||r.material.color.clone(),r.material.color.copy(r.material._color),r.material.opacity=r.material._opacity,this.enabled?this.axis&&(r.name===this.axis?(r.material.opacity=1,r.material.color.lerp(new i.Color(1,1,1),.5)):this.axis.split("").some(function(e){return r.name===e})?(r.material.opacity=1,r.material.color.lerp(new i.Color(1,1,1),.5)):(r.material.opacity*=.25,r.material.color.lerp(new i.Color(1,1,1),.5))):(r.material.opacity*=.5,r.material.color.lerp(new i.Color(1,1,1),.5))}else r.visible=!1,"AXIS"===r.name?(r.position.copy(this.worldPositionStart),r.visible=!!this.axis,"X"===this.axis&&(O.setFromEuler(z.set(0,0,0)),r.quaternion.copy(t).multiply(O),Math.abs(A.copy(k).applyQuaternion(t).dot(this.eye))>.9&&(r.visible=!1)),"Y"===this.axis&&(O.setFromEuler(z.set(0,0,Math.PI/2)),r.quaternion.copy(t).multiply(O),Math.abs(A.copy(W).applyQuaternion(t).dot(this.eye))>.9&&(r.visible=!1)),"Z"===this.axis&&(O.setFromEuler(z.set(0,Math.PI/2,0)),r.quaternion.copy(t).multiply(O),Math.abs(A.copy(q).applyQuaternion(t).dot(this.eye))>.9&&(r.visible=!1)),"XYZE"===this.axis&&(O.setFromEuler(z.set(0,Math.PI/2,0)),A.copy(this.rotationAxis),r.quaternion.setFromRotationMatrix(V.lookAt(T,A,W)),r.quaternion.multiply(O),r.visible=this.dragging),"E"===this.axis&&(r.visible=!1)):"START"===r.name?(r.position.copy(this.worldPositionStart),r.visible=this.dragging):"END"===r.name?(r.position.copy(this.worldPosition),r.visible=this.dragging):"DELTA"===r.name?(r.position.copy(this.worldPositionStart),r.quaternion.copy(this.worldQuaternionStart),G.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),G.applyQuaternion(this.worldQuaternionStart.clone().invert()),r.scale.copy(G),r.visible=this.dragging):(r.quaternion.copy(t),this.dragging?r.position.copy(this.worldPositionStart):r.position.copy(this.worldPosition),this.axis&&(r.visible=-1!==this.axis.search(r.name)))}i.Object3D.prototype.updateMatrixWorld.call(this)}};r.prototype=Object.assign(Object.create(i.Object3D.prototype),{constructor:r,isTransformControlsGizmo:!0});var s=function(){i.Mesh.call(this,new i.PlaneBufferGeometry(1e5,1e5,2,2),new i.MeshBasicMaterial({visible:!1,wireframe:!0,side:i.DoubleSide,transparent:!0,opacity:.1,toneMapped:!1})),this.type="TransformControlsPlane";var e=new i.Vector3(1,0,0),t=new i.Vector3(0,1,0),n=new i.Vector3(0,0,1),o=new i.Vector3,a=new i.Vector3,r=new i.Vector3,s=new i.Matrix4,l=new i.Quaternion;this.updateMatrixWorld=function(){var h=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(h="local"),e.set(1,0,0).applyQuaternion("local"===h?this.worldQuaternion:l),t.set(0,1,0).applyQuaternion("local"===h?this.worldQuaternion:l),n.set(0,0,1).applyQuaternion("local"===h?this.worldQuaternion:l),r.copy(t),this.mode){case"translate":case"scale":switch(this.axis){case"X":r.copy(this.eye).cross(e),a.copy(e).cross(r);break;case"Y":r.copy(this.eye).cross(t),a.copy(t).cross(r);break;case"Z":r.copy(this.eye).cross(n),a.copy(n).cross(r);break;case"XY":a.copy(n);break;case"YZ":a.copy(e);break;case"XZ":r.copy(n),a.copy(t);break;case"XYZ":case"E":a.set(0,0,0)}break;case"rotate":default:a.set(0,0,0)}0===a.length()?this.quaternion.copy(this.cameraQuaternion):(s.lookAt(o.set(0,0,0),a,r),this.quaternion.setFromRotationMatrix(s)),i.Object3D.prototype.updateMatrixWorld.call(this)}};s.prototype=Object.assign(Object.create(i.Mesh.prototype),{constructor:s,isTransformControlsPlane:!0});var l=n("vy4U"),h=n.n(l),c=(n("C+g1")(i),{name:"RunBox",data:function(){return{width:0,height:0,scene:null,camera:null,controls:null,renderer:null,isOpenDoor:!0,amdLight:null,dirLight:null,ponLight:null,formControls:null,line:null,raycaster:"",mouse:"",dummy:"",curve:null,loopTime:1e4,runBox:null,cubeList:[]}},methods:{initScene:function(){var e=this.$refs.webglDom;this.width=e.offsetWidth,this.height=e.offsetHeight,this.scene=new i.Scene,this.scene.fog=new i.Fog(21879,1,2800),this.scene.background=new i.Color(0),this.raycaster=new i.Raycaster,this.mouse=new i.Vector2,this.dummy=new i.Object3D},initCamera:function(){this.camera=new i.PerspectiveCamera(45,this.width/this.height,.01,1e4),this.camera.position.set(0,0,800),this.add(this.camera),this.camera.lookAt(this.scene.position)},initControls:function(){this.controls=new o.a(this.camera,this.renderer.domElement)},initLight:function(){this.amdLight=new i.AmbientLight("#aaa"),this.dirLight=new i.DirectionalLight("#aaa"),this.ponLight=new i.PointLight("#aaa"),this.amdLight.position.set(0,0,0),this.dirLight.position.set(0,0,0),this.ponLight.position.set(0,0,0),this.add(this.amdLight),this.add(this.dirLight),this.add(this.ponLight)},initRenderer:function(){var e=this;this.renderer=new i.WebGLRenderer({antialias:!0,alpha:!0}),this.renderer.setClearColor(4620980,1),this.renderer.setClearAlpha(0),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.renderer.setSize(this.width,this.height),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=i.PCFSoftShadowMap,this.$refs.webglDom.appendChild(this.renderer.domElement),this.formControls=new a(this.camera,this.renderer.domElement);var t=new i.Vector2;this.renderer.domElement.addEventListener("click",function(e){t.x=e.clientX/window.innerWidth*2-1,t.y=-e.clientY/window.innerHeight*2+1},!1);var n=new i.Raycaster;n.setFromCamera(t,this.camera);var o=n.intersectObjects(this.cubeList);console.log(o),o.length&&o.forEach(function(t){e.formControls.attach(t.object),e.add(e.formControls)}),this.formControls.addEventListener("dragging-changed",function(t){if(!t.value){var n=e.curve.getPoints(50);e.line.geometry.setFromPoints(n)}}),this.render()},initScreen:function(){var e=this;this.cubeList=[{x:100,y:50,z:-100},{x:100,y:-50,z:100},{x:-100,y:0,z:100},{x:-100,y:0,z:-100}].map(function(t){return e.addBox(10,10,10,"#fff",t.x,t.y,t.z)}),this.curve=new i.CatmullRomCurve3(this.cubeList.map(function(e){return e.position})),this.curve.curveType="chordal",this.curve.closed=!0;var t=this.curve.getPoints(50);this.line=new i.LineLoop((new i.BufferGeometry).setFromPoints(t),new i.LineBasicMaterial({color:65280})),this.runBox=this.addBox(10,10,10,"#fff",0,0,0),this.add(this.line)},changePosition:function(e){var t=this.curve.getPointAt(e);this.runBox.position.copy(t)},changeLookAt:function(e){var t=this.curve.getTangentAt(e).add(this.runBox.position);this.runBox.lookAt(t)},addBox:function(e,t,n,o,a,r,s){var l=new i.BoxGeometry(e,t,n),h=new i.MeshLambertMaterial({color:o}),c=new i.Mesh(l,h);return c.position.set(a,r,s),this.add(c),c},add:function(e){this.scene.add(e)},render:function(){var e=Date.now()%this.loopTime/this.loopTime;this.changePosition(e),this.changeLookAt(e);var t=this.camera.position.clone();this.ponLight.position.set(t.x,t.y,t.z),this.renderer.render(this.scene,this.camera),h.a.update(),requestAnimationFrame(this.render)},init:function(){this.initScene(),this.initCamera(),this.initLight(),this.initScreen(),this.initRenderer(),this.initControls()}},mounted:function(){this.$nextTick(this.init)}}),p={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"wrap"},[t("div",{ref:"webglDom",staticClass:"webglDom"})])},staticRenderFns:[]};var u=n("VU/8")(c,p,!1,function(e){n("2F6b")},null,null);t.default=u.exports}});
//# sourceMappingURL=6.803f2aa9ae6383fb9b84.js.map